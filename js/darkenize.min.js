"use strict";function darkenize(){this.dark_theme_attribute=[{type:"background",value:"background-color"},{type:"text",value:"color"},{type:"border",value:"border-bottom-color"},{type:"border",value:"border-top-color"},{type:"border",value:"border-left-color"},{type:"border",value:"border-right-color"}],this.color_preset={text:{threshold:1,control:2,flag:"lt"},background:{threshold:.4,control:.2,flag:"gt"},border:{threshold:.3,control:1.4,flag:"gt"}},this.stop_elem=["meta","head","link","script","style","title","svg","pre"],this.dynamic_coloring=!1}darkenize.prototype.autoColorize=function(e){var r;r=e?e:0!=this.stop_elem.length?document.querySelectorAll("*:not("+this.stop_elem.join("):not(")+")"):document.querySelectorAll("*"),r.forEach(function(e){this.setColorForDarkTheme(e)},this)},darkenize.prototype.setColorForDarkTheme=function(e){var r;if(void 0===typeof window)throw"This method is only available in web browser";return r=window.getComputedStyle(e),this.dark_theme_attribute.forEach(function(t){e.style.setProperty(t.value,this.getColorForDarkTheme(r[t.value],this.color_preset[t.type]))},this),e},darkenize.prototype.getColorForDarkTheme=function(e,r){var t=darkenize.parseColor(e),o=e,a=r.threshold,l=r.control,n=1;if("rgb"==t.space){var i=darkenize.rgb2hsv(t.value[0],t.value[1],t.value[2]);"gt"==r.flag&&i.v>a?(i.v=l*n*i.v>1?1:l*n*i.v,o=darkenize.hsv2rgb(i.h,i.s,i.v,"hex")):"lt"==r.flag&&i.v<a&&(i.v=l*n*i.v>1?1:l*n*i.v,o=darkenize.hsv2rgb(i.h,i.s,i.v,"hex"))}else"hsv"==t.space&&("gt"==r.flag&&t.value[2]>a?(t.value[2]=l*n*t.value[2]>1?1:l*n*t.value[2],o=darkenize.hsv2rgb(t.value[0],t.value[1],t.value[2],"hex")):"lt"==r.flag&&t.value[2]<a&&(t.value[2]=l*n*t.value[2]>1?1:l*n*t.value[2],o=darkenize.hsv2rgb(t.value[0],t.value[1],t.value[2],"hex")));return o},darkenize.rgb2hsv=function(e,r,t,o){var a=o||"object",l={_r:e/255,_g:r/255,_b:t/255},n=Object.keys(l).reduce(function(e,r){return l[e]>l[r]?e:r}),i=Object.keys(l).reduce(function(e,r){return l[e]<l[r]?e:r}),u=l[n]-l[i],s=60;if("_r"==n?s*=(l._g-l._b)/u%6:"_g"==n?s*=(l._b-l._r)/u+2:"_b"==n&&(s*=(l._r-l._g)/u+4),"object"==a)return{h:0==u?0:s,s:0==l[n]?0:u/l[n],v:l[n]}},darkenize.hsv2rgb=function(e,r,t,o){var a=o||"hex",l=e<0?e+360:e,n={_r:0,_g:0,_b:0},i=r*t,u=i*(1-Math.abs(l/60%2-1)),s=t-i;return l>=0&&l<60?(n._r=i,n._g=u):l>=60&&l<120?(n._r=u,n._g=i):l>=120&&l<180?(n._g=i,n._b=u):l>=180&&l<240?(n._g=u,n._b=i):l>=240&&l<300?(n._r=u,n._b=i):l>=300&&l<360&&(n._r=i,n._b=u),"object"==a?{r:255*(n._r+s),g:255*(n._g+s),b:255*(n._b+s)}:"hex"==a?"#"+((1<<24)+(Math.floor(255*(n._r+s))<<16)+(Math.floor(255*(n._g+s))<<8)+Math.floor(255*(n._b+s))).toString(16).slice(1):void 0},darkenize.parseColor=function(e){var r,t;if(e.indexOf("#"))e.indexOf("rgb")?e.indexOf("hsv")||(t="hsv",r=e.match(/([0-9]*[.])?[0-9]+/g).map(function(e){return parseFloat(e)})):(t="rgb",r=e.match(/([0-9]*[.])?[0-9]+/g).map(function(e){return parseFloat(e)}));else{t="rgb",4==e.length&&(e=e.replace(/\w/g,function(e){return e+e}));var o=parseInt(e.substr(1),16);r=[o>>16&255,o>>8&255,255&o]}return{space:t,value:r}},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=darkenize:window.darkenize=darkenize;